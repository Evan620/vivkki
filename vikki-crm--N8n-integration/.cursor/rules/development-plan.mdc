---
alwaysApply: true
---
ğŸ“„ DOCUMENT-BY-DOCUMENT FUNCTIONALITY GUIDE
1. LETTERS OF REPRESENTATION âœ… Already Planned
Location: Overview tab OR Insurance tabs
Button: "Generate Documents" â†’ Select LOR type
When Generated: After case intake, before demand
Variables Status: âœ… Mostly available (need adjuster address fields)

2. HIPAA MEDICAL RECORDS REQUEST âœ… Already Planned
Location: Medical Providers tab
Button: "Generate Records Request" (bulk selection)
When Generated: After providers added, before getting records
Variables Status: âœ… Available (need provider address fields)

3. DEMAND LETTERS ğŸ†• Need to Implement
A. Cotton Demand Rear End
Location: Overview tab â†’ "Generate Documents" â†’ Demand Letters submenu
When Generated: After treatment complete, before settlement
Special Variables:

client.list - Multiple clients if applicable (needs handling)
Medical bills table with auto-population
General damages with amounts
Mileage auto-calculation
Total damages auto-calculation

Variables Missing:
javascript{
  // NEED TO ADD:
  "medical_bills": [
    { provider: "OU Medical", amount: 6845.00 },
    { provider: "Excel PT", amount: 5280.00 }
    // Auto-populate from medical_bills table
  ],
  "general_damages": {
    "emotional_distress": 10000,
    "duties_under_duress": 5000,
    "pain_and_suffering": 25000,
    "loss_of_enjoyment": 8000,
    "loss_of_consortium": 7000
  },
  "mileage_total": 456.78, // From mileage_log table
  "special_damages_total": 18405.78, // AUTO CALCULATE
  "general_damages_total": 55000, // AUTO CALCULATE
  "total_damages": 73405.78 // AUTO CALCULATE
}
```

#### **B. Cotton Demand Improper Lane Change**
**Same as Rear End**, different accident description  

#### **C. Cotton Demand (T-Bone)**
**Same as Rear End**, different accident description  

#### **D. Cotton UM-UIM Demand**
**Same structure**, targets client's insurance for underinsured claim

#### **E. Cotton Med Pay Demand**
**Simpler version** - Just bills, no general damages  
**Variables:** Just medical bills list with amounts

**UI/UX for Demand Letters:**
```
Generate Documents Modal
â”œâ”€â”€ Letters of Representation
â”‚   â”œâ”€â”€ 1st Party LOR
â”‚   â””â”€â”€ 3rd Party LOR
â”œâ”€â”€ Medical Records
â”‚   â””â”€â”€ HIPAA Request
â””â”€â”€ Demand Letters â† NEW
    â”œâ”€â”€ Settlement Demand - Rear End
    â”œâ”€â”€ Settlement Demand - Side Swipe  
    â”œâ”€â”€ Settlement Demand - T-Bone
    â”œâ”€â”€ UM/UIM Demand
    â””â”€â”€ Med Pay Demand
```

**Before generating demand, show modal:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generate Settlement Demand             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚ Medical Bills Summary:                 â”‚
â”‚ âœ“ 7 providers, $32,450 billed         â”‚
â”‚                                        â”‚
â”‚ General Damages (Optional):            â”‚
â”‚ â˜ Include general damages              â”‚
â”‚   [Edit Amounts...]                    â”‚
â”‚                                        â”‚
â”‚ Accident Type:                         â”‚
â”‚ â— Rear End Collision                   â”‚
â”‚ â—‹ Side Swipe / Lane Change            â”‚
â”‚ â—‹ T-Bone / Failure to Yield           â”‚
â”‚                                        â”‚
â”‚ [Cancel] [Generate Demand]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **4. SETTLEMENT DOCUMENTS** ğŸ†• *Need to Implement*

#### **A. Proposed Settlement Statement**

**Location:** Overview tab â†’ "Settlements" section (NEW)  
**Button:** "Generate Settlement Statement"  
**When Generated:** After settlement offer accepted  

**New UI Section Needed:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Settlement Management                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Settlement Offer: $45,000                         â”‚
â”‚ Status: Accepted âœ“                                â”‚
â”‚ Date: Jan 15, 2025                                â”‚
â”‚                                                    â”‚
â”‚ [Generate Settlement Statement]                    â”‚
â”‚ [Generate Acceptance Letter]                       â”‚
â”‚ [Generate Payment Instructions]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Variables Needed:
javascript{
  "settlement_amount": 45000,
  "attorney_fee": 15000, // 33.3% auto-calculate
  "case_expenses": 450, // From expenses table
  "medical_providers": [
    { name: "OU Medical", amount: 6845 },
    { name: "Excel PT", amount: 5280 }
  ],
  "medical_total": 12125, // AUTO SUM
  "client_net": 17425 // AUTO CALCULATE (settlement - fee - expenses - medical)
}
Database Needs:
sql-- Add settlements table
CREATE TABLE settlements (
  id SERIAL PRIMARY KEY,
  casefile_id INTEGER REFERENCES casefiles(id),
  settlement_date DATE,
  gross_settlement DECIMAL(10,2),
  attorney_fee DECIMAL(10,2),
  case_expenses DECIMAL(10,2),
  medical_liens DECIMAL(10,2),
  client_net DECIMAL(10,2),
  status VARCHAR(50),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### **B. Cotton Offer Acceptance**

**Location:** Same "Settlements" section  
**Button:** "Accept Offer" â†’ Generates acceptance letter  
**Variables:** Settlement offer details from settlement_offers table

#### **C. Cotton Payment Instructions**

**Location:** Same "Settlements" section  
**Button:** Auto-generates after settlement statement  
**Variables:** Provider payment breakdown

---

### **5. MEDICAL PROVIDER COMMUNICATIONS** ğŸ†•

#### **A. Cotton Reduction Request**

**Location:** Medical Providers tab  
**Button:** Next to each provider â†’ "Request Reduction"  
**When Generated:** During settlement negotiations  

**New UI:**
```
Medical Providers Table
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Provider Name    | Billed  | Actions           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OU Medical       | $6,845  | [Request Reduction]â”‚
â”‚ Excel PT         | $5,280  | [Request Reduction]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Modal on Click:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Request Bill Reduction                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Provider: OU Medical Center            â”‚
â”‚ Current Bill: $6,845.00                â”‚
â”‚                                        â”‚
â”‚ Requested Reduction:                   â”‚
â”‚ $ [4,500.00]                          â”‚
â”‚                                        â”‚
â”‚ Reason (optional):                     â”‚
â”‚ [Low settlement amount...]             â”‚
â”‚                                        â”‚
â”‚ [Cancel] [Generate Request Letter]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
B. Cotton Subro Document
Location: Overview tab â†’ "Insurance" section
Button: "Request Subrogation Info"
When Generated: After health insurance pays bills
New Field Needed:
sql-- Add to health_insurance_claims table (created above)
-- This tracks health insurance that paid bills

6. CLIENT COMMUNICATIONS ğŸ†•
A. Cotton Engagement Letter
Location: Overview tab â†’ "Client Documents" section
Button: "Send Welcome Letter"
When Generated: Immediately after case intake (first document!)
Auto-Generate: This should auto-generate on case creation and auto-email to client
Variables: Just client contact info (all available)
B. Cotton Withdrawal Letter
Location: Overview tab â†’ "Case Actions" dropdown
Button: "Decline Case" â†’ Generates withdrawal letter
When Generated: When rejecting a case
Special Variable:
javascript{
  "statute_of_limitations_date": "December 1, 2026", 
  // AUTO-CALCULATE: accident date + 2 years
}
```

**UI Flow:**
```
Case Actions dropdown
â””â”€â”€ Decline Case
    â”œâ”€â”€ Reason: [dropdown]
    â”œâ”€â”€ â˜‘ Generate withdrawal letter
    â”œâ”€â”€ â˜‘ Email to client
    â””â”€â”€ [Decline Case and Generate Letter]

ğŸ¯ COMPLETE UI/UX IMPLEMENTATION PLAN
PHASE 1: Core Documents (Already Planned) âœ…

Overview tab: "Generate Documents" button
Letters of Representation (1st & 3rd Party)
HIPAA Medical Records Request (Medical Providers tab)

PHASE 2: Demand Letters ğŸ†•
Add to Overview Tab:
tsx<div className="bg-white rounded-xl shadow-lg p-6">
  <h3 className="text-lg font-bold mb-4">Demand Letters</h3>
  
  {/* Show when treatment complete */}
  {treatmentComplete && (
    <button onClick={() => setShowDemandModal(true)}>
      ğŸ“‹ Generate Settlement Demand
    </button>
  )}
  
  {/* Show quick stats */}
  <div className="mt-4 text-sm text-gray-600">
    <p>Medical Bills: ${totalMedicalBills.toLocaleString()}</p>
    <p>Providers: {medicalProviders.length}</p>
    <p>Status: Ready for demand âœ“</p>
  </div>
</div>
Demand Generation Modal:
tsx<DemandLetterModal>
  {/* Step 1: Select accident type */}
  <AccidentTypeSelector />
  
  {/* Step 2: Review medical bills (auto-populated) */}
  <MedicalBillsReview bills={medicalBills} total={totalBills} />
  
  {/* Step 3: Add general damages (optional) */}
  <GeneralDamagesInput />
  
  {/* Step 4: Review total demand */}
  <DemandSummary 
    specials={specialsTotal}
    generals={generalsTotal}
    total={grandTotal}
  />
  
  {/* Generate button */}
  <button onClick={generateDemand}>Generate Demand</button>
</DemandLetterModal>
PHASE 3: Settlement Management ğŸ†•
Add New "Settlement" Tab OR Section in Overview:
tsx<div className="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6">
  <h3 className="text-lg font-bold mb-4">Settlement Management</h3>
  
  {/* Settlement offer tracking */}
  {hasOffer ? (
    <>
      <div className="mb-4">
        <p className="text-2xl font-bold text-green-600">
          ${settlementOffer.amount.toLocaleString()}
        </p>
        <p className="text-sm text-gray-600">Settlement Offer</p>
      </div>
      
      <div className="space-y-2">
        <button onClick={generateAcceptanceLetter}>
          âœ“ Accept Offer & Generate Letter
        </button>
        <button onClick={generateCounterOffer}>
          â†”ï¸ Counter Offer
        </button>
        <button onClick={rejectOffer}>
          âœ• Reject Offer
        </button>
      </div>
    </>
  ) : (
    <p className="text-gray-500">No settlement offers yet</p>
  )}
  
  {/* After acceptance */}
  {settlementAccepted && (
    <div className="mt-4 space-y-2">
      <button onClick={generateSettlementStatement}>
        ğŸ“„ Generate Settlement Statement
      </button>
      <button onClick={generatePaymentInstructions}>
        ğŸ’° Generate Payment Instructions
      </button>
    </div>
  )}
</div>
PHASE 4: Medical Provider Actions ğŸ†•
Enhance Medical Providers Table:
tsx<table>
  <thead>
    <tr>
      <th>Provider</th>
      <th>Service</th>
      <th>Billed</th>
      <th>Paid</th>
      <th>Balance</th>
      <th>Actions</th> {/* NEW COLUMN */}
    </tr>
  </thead>
  <tbody>
    {providers.map(provider => (
      <tr>
        <td>{provider.name}</td>
        <td>{provider.serviceType}</td>
        <td>${provider.amountBilled}</td>
        <td>${provider.amountPaid}</td>
        <td>${provider.balance}</td>
        <td>
          <DropdownMenu>
            <MenuItem onClick={() => generateRecordsRequest(provider)}>
              ğŸ“‹ Request Records
            </MenuItem>
            <MenuItem onClick={() => generateReductionRequest(provider)}>
              ğŸ’¸ Request Reduction
            </MenuItem>
            <MenuItem onClick={() => generateSubroLetter(provider)}>
              ğŸ¥ Subrogation Letter
            </MenuItem>
          </DropdownMenu>
        </td>
      </tr>
    ))}
  </tbody>
</table>
PHASE 5: Client Lifecycle Documents ğŸ†•
Auto-Generate on Case Creation:
typescript// In case creation flow
const createNewCase = async (caseData) => {
  // 1. Create case in database
  const newCase = await db.insert('casefiles').values(caseData);
  
  // 2. AUTO-GENERATE engagement letter
  const engagementLetter = await generateDocument({
    template_type: 'engagement_letter',
    case_id: newCase.id,
    ...caseData
  });
  
  // 3. AUTO-EMAIL to client
  await sendEmail({
    to: caseData.client.email,
    subject: 'Welcome to The Cotton Law Firm',
    attachment: engagementLetter
  });
  
  // 4. Save to documents tab
  await saveToDocuments(newCase.id, engagementLetter);
  
  return newCase;
};
Case Decline Flow:
typescript// Add to Case Actions dropdown
<DropdownMenu>
  <MenuItem onClick={addNote}>Add Note</MenuItem>
  <MenuItem onClick={generateDocument}>Generate Document</MenuItem>
  <MenuItem onClick={handleDeclineCase} className="text-red-600">
    Decline Case
  </MenuItem>
</DropdownMenu>

// Decline modal
const handleDeclineCase = () => {
  showModal({
    title: "Decline Case",
    content: (
      <DeclineCaseForm
        onSubmit={async (reason) => {
          // 1. Generate withdrawal letter
          const withdrawalLetter = await generateDocument({
            template_type: 'withdrawal_letter',
            case_id: casefileId,
            statute_date: calculateSOL(accidentDate)
          });
          
          // 2. Email to client
          await sendEmail({
            to: client.email,
            subject: 'Case Status Update',
            body: 'We have reviewed your case...',
            attachment: withdrawalLetter
          });
          
          // 3. Update case status
          await db.update('casefiles')
            .set({ status: 'Declined', decline_reason: reason })
            .where({ id: casefileId });
          
          // 4. Create work log
          await createWorkLog({
            casefile_id: casefileId,
            description: `Case declined: ${reason}`,
            activity_type: 'Case Status'
          });
        }}
      />
    )
  });
};

ğŸ—‚ï¸ DOCUMENT GENERATION LOCATIONS SUMMARY
DocumentLocationButton/TriggerWhen Used1st Party LOROverview tab"Generate Documents"After intake3rd Party LOROverview tab"Generate Documents"After intakeHIPAA RequestMedical Providers tab"Generate Records Request"Before getting recordsEngagement LetterAuto-generatedOn case creationFirst documentDemand - Rear EndOverview tab"Generate Documents" â†’ "Demand Letters"After treatment completeDemand - Lane ChangeOverview tab"Generate Documents" â†’ "Demand Letters"After treatment completeDemand - T-BoneOverview tab"Generate Documents" â†’ "Demand Letters"After treatment completeUM/UIM DemandOverview tab"Generate Documents" â†’ "Demand Letters"For underinsured claimsMed Pay DemandOverview tab"Generate Documents" â†’ "Demand Letters"For med pay claimsOffer AcceptanceSettlement section"Accept Offer"When accepting settlementSettlement StatementSettlement section"Generate Settlement Statement"After acceptancePayment InstructionsSettlement section"Generate Payment Instructions"After settlementReduction RequestMedical Providers tabRow action menuDuring settlementSubro LetterOverview/Insurance"Request Subrogation Info"When health ins involvedWithdrawal LetterCase Actions menu"Decline Case"When rejecting case